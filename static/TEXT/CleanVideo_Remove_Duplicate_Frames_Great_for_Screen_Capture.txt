import subprocess
import os
from sys import argv

''' keywords: remove dupicate frames no dupes The remove_static_frames function uses ffmpeg to remove static frames from a video. The function takes two arguments: input_video and output_video. The input_video is the path to the video file from which static frames should be removed, and the output_video is the path to the resulting video file with static frames removed. The function uses the mpdecimate filter to detect and remove duplicate frames from the video. The resulting video is encoded using the libx264 codec with a constant rate factor of 23 and a fast encoding preset. The function prints a message indicating that the video with static frames removed has been created. If an error occurs during the ffmpeg command execution, the function prints an error message. The __name__ == "__main__" block reads the input_video path from the command-line arguments and generates the output_video path by appending "_nodupes" to the input video file name. The remove_static_frames function is then called with the input and output video paths. The script can be run from the command line with the input video file path as an argument to remove static frames from the video. For example: python CleanVideo.py input_video.mp4 This script can be used to preprocess videos by removing static frames before further processing or analysis.'''
def remove_static_frames(input_video, output_video):
    try:
        cmd = [
            'ffmpeg', '-i', input_video,
            '-vf', 'mpdecimate,setpts=N/FRAME_RATE/TB',
            '-c:v', 'libx264', '-crf', '23', '-preset', 'fast',
            output_video
        ]
        subprocess.run(cmd, check=True)
        print(f"Video with static frames removed: {output_video}")
    except subprocess.CalledProcessError as e:
        print(f"Error removing static frames: {e}")

if __name__ == "__main__":
    input_video = argv[1]
    output_video = input_video[:4]+'_nodupes.mp4'
    remove_static_frames(input_video, output_video)
